// zvmone: Fast Zond Virtual Machine implementation
// Copyright 2022 The evmone Authors.
// SPDX-License-Identifier: Apache-2.0

#include <gmock/gmock.h>
#include <test/state/hash_utils.hpp>
#include <test/state/rlp.hpp>
#include <test/state/state.hpp>
#include <test/utils/utils.hpp>
#include <bit>

using namespace zvmone;
using namespace zvmc::literals;
using namespace intx;
using namespace testing;

static constexpr auto emptyBytesHash =
    0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470_bytes32;

static constexpr auto emptyMPTHash =
    0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421_bytes32;

TEST(state_rlp, empty_bytes_hash)
{
    EXPECT_EQ(keccak256({}), emptyBytesHash);
}

TEST(state_rlp, empty_mpt_hash)
{
    const auto rlp_null = rlp::encode(0);
    EXPECT_EQ(rlp_null, bytes{0x80});
    EXPECT_EQ(keccak256(rlp_null), emptyMPTHash);
}

TEST(state_rlp, encode_string_short)
{
    EXPECT_EQ(rlp::encode(0x01), "01"_hex);
    EXPECT_EQ(rlp::encode(0x31), "31"_hex);
    EXPECT_EQ(rlp::encode(0x7f), "7f"_hex);
}

TEST(state_rlp, encode_string_long)
{
    const auto buffer = std::make_unique<uint8_t[]>(0xffffff);

    const auto r1 = rlp::encode({buffer.get(), 0xaabb});
    EXPECT_EQ(r1.size(), 0xaabb + 3);
    EXPECT_EQ(hex({r1.data(), 10}), "b9aabb00000000000000");

    const auto r2 = rlp::encode({buffer.get(), 0xffff});
    EXPECT_EQ(r2.size(), 0xffff + 3);
    EXPECT_EQ(hex({r2.data(), 10}), "b9ffff00000000000000");

    const auto r3 = rlp::encode({buffer.get(), 0xaabbcc});
    EXPECT_EQ(r3.size(), 0xaabbcc + 4);
    EXPECT_EQ(hex({r3.data(), 10}), "baaabbcc000000000000");

    const auto r4 = rlp::encode({buffer.get(), 0xffffff});
    EXPECT_EQ(r4.size(), 0xffffff + 4);
    EXPECT_EQ(hex({r4.data(), 10}), "baffffff000000000000");
}

TEST(state_rlp, encode_c_array)
{
    const uint64_t a[]{1, 2, 3};
    EXPECT_EQ(hex(rlp::encode(a)), "c3010203");
}

TEST(state_rlp, encode_vector)
{
    const auto x = 0xe1e2e3e4e5e6e7d0d1d2d3d4d5d6d7c0c1c2c3c4c5c6c7b0b1b2b3b4b5b6b7_u256;
    EXPECT_EQ(
        rlp::encode(x), "9fe1e2e3e4e5e6e7d0d1d2d3d4d5d6d7c0c1c2c3c4c5c6c7b0b1b2b3b4b5b6b7"_hex);
    const std::vector<uint256> v(0xffffff / 32, x);
    const auto r = rlp::encode(v);
    EXPECT_EQ(r.size(), v.size() * 32 + 4);
}

TEST(state_rlp, encode_account_with_balance)
{
    const auto expected =
        "f8 44"
        "80"
        "01"
        "a0 56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421"
        "a0 c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470"_hex;

    const auto r = rlp::encode_tuple(uint64_t{0}, 1_u256, emptyMPTHash, emptyBytesHash);
    EXPECT_EQ(r, expected);
}

TEST(state_rlp, encode_storage_value)
{
    const auto value = 0x00000000000000000000000000000000000000000000000000000000000001ff_bytes32;
    const auto xvalue = rlp::encode(rlp::trim(value));
    EXPECT_EQ(xvalue, "8201ff"_hex);
}

TEST(state_rlp, encode_mpt_node)
{
    const auto path = "2041"_hex;
    const auto value = "765f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f31"_hex;
    const auto node = rlp::encode_tuple(path, value);
    EXPECT_EQ(node, "e18220419d765f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f5f31"_hex);
}

struct CustomStruct
{
    uint64_t a;
    bytes b;
};

inline bytes rlp_encode(const CustomStruct& t)
{
    return rlp::encode_tuple(t.a, t.b);
}

TEST(state_rlp, encode_custom_struct)
{
    const CustomStruct t{1, {0x02, 0x03}};
    EXPECT_EQ(rlp::encode(t), "c4 01 820203"_hex);
}

TEST(state_rlp, encode_custom_struct_list)
{
    const std::vector<CustomStruct> v{{1, {0x02, 0x03}}, {4, {0x05, 0x06}}};
    EXPECT_EQ(rlp::encode(v), "ca c401820203 c404820506"_hex);
}

TEST(state_rlp, encode_uint64)
{
    EXPECT_EQ(rlp::encode(uint64_t{0}), "80"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{1}), "01"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x7f}), "7f"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x80}), "8180"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x81}), "8181"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xff}), "81ff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x0100}), "820100"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffff}), "82ffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x010000}), "83010000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffff}), "83ffffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x01000000}), "8401000000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffffff}), "84ffffffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x0100000000}), "850100000000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffffffff}), "85ffffffffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x010000000000}), "86010000000000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffffffffff}), "86ffffffffffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x01000000000000}), "8701000000000000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffffffffffff}), "87ffffffffffffff"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0x0100000000000000}), "880100000000000000"_hex);
    EXPECT_EQ(rlp::encode(uint64_t{0xffffffffffffffff}), "88ffffffffffffffff"_hex);
}

inline bytes to_significant_be_bytes(uint64_t x)
{
    const auto byte_width = (std::bit_width(x) + 7) / 8;
    const auto leading_zero_bits = std::countl_zero(x) & ~7;  // Leading bits rounded down to 8x.
    const auto trimmed_x = x << leading_zero_bits;            // Significant bytes moved to the top.

    uint8_t b[sizeof(x)];
    intx::be::store(b, trimmed_x);
    return bytes{b, static_cast<size_t>(byte_width)};
}

/// The "custom" implementation of RLP encoding of uint64. It trims leading zero bytes and
/// manually constructs bytes with variadic-length encoding.
inline bytes rlp_encode_uint64(uint64_t x)
{
    static constexpr uint8_t ShortBase = 0x80;
    if (x < ShortBase)  // Single-byte encoding.
        return bytes{(x == 0) ? ShortBase : static_cast<uint8_t>(x)};

    const auto b = to_significant_be_bytes(x);
    return static_cast<uint8_t>(ShortBase + b.size()) + b;
}

TEST(state_rlp, encode_uint64_custom)
{
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0}), "80"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{1}), "01"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x7f}), "7f"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x80}), "8180"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x81}), "8181"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xff}), "81ff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x0100}), "820100"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffff}), "82ffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x010000}), "83010000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffff}), "83ffffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x01000000}), "8401000000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffffff}), "84ffffffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x0100000000}), "850100000000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffffffff}), "85ffffffffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x010000000000}), "86010000000000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffffffffff}), "86ffffffffffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x01000000000000}), "8701000000000000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffffffffffff}), "87ffffffffffffff"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0x0100000000000000}), "880100000000000000"_hex);
    EXPECT_EQ(rlp_encode_uint64(uint64_t{0xffffffffffffffff}), "88ffffffffffffffff"_hex);
}

TEST(state_rlp, tx_to_rlp_eip1559)
{
    state::Transaction tx{};

    tx.kind = zvmone::state::Transaction::Kind::eip1559;
    tx.data = ""_b;
    tx.gas_limit = 30000;
    tx.max_gas_price = 14237787676;
    tx.max_priority_gas_price = 0;
    tx.sender = "Z165f65c2985c4564b13fed095e35cd00abb8084ea6df59a4"_address;
    tx.to = "Z8cec3d42131510245da4796e43ed623d715a4d5899cb44b8"_address;
    tx.value = 73360267083380739_u256;
    tx.access_list = {};
    tx.nonce = 132949;
    tx.public_key =
        "01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"_hex;
    tx.signature =
        "34da899b3c5d5ea3a110ec6acfd6388ef9a7f322758cd5b641dd2d838b33eb17103e7e6df7d2f0a3aa019e9a65ee8cbd32a44a15717c4c2f1c1e46b6c8ff1543ef292905f50b2a781eafe151b588f29f54b79f76eee7fb46ca37158e89f8051caa5591af5c12affc28dbbc58a9a587a5fd5b439fd0c809af864613bb789f1978ef7f822f806bdde4103722e251b77d1b662ea4e4924436d22508b94c3239433caa6d1c2ad24c6ad34dc6c4b53054967cb3f3a71d948aa80b1825982c3e7a4790326d28c0ee270b8d475b434a5f9c2caa6e1358dfba4ed631729f37b35158364df2adb9540ee64e2619b050e67d2b9c008f4eaae36a0dd28631f7629e28ff835d769b9b78d733d8e621643efc79496afc4a3dcec6b726e89ba586d0944e1c32b5992d0cc19acde76ec383e3d707626aaf4df869ff0702f03af8aedeffd41f22819eb6fd788ebb0e54165dc940e5601d599dcb3c20d52e5298a215e4a4519dc51b6ea6c305f5778722fe09d4f9aab844993a35ef8b2ffc72f1f26cc715abfa9c420ad2eb6606b29c39a1cdd7dcba3320e29d19d2cc2ee768a2db1f64728dbc768075541dda04db2e49f54bf57ad096c8bc72a44bb96cf7798cb11ff329c82b9185f0b638649b440717721e6fca5eaf92849547f96d1051c6ed873c46f497673ea6cc7a13887601ab581c69bcd57760917fecd4e52ac07ac7ba40a3a1ef6421160c99971a7bce755c02d7113321c5ffb568a1044b26aa9c2cab7c8fcf1b5a3db840d95e7744dee180075aef2995202185ffc01f6d2da6a923f30f6aed2179e053930aee64ff00d85e644690283de5ce54ea0e0c2ee07823152ed3cae09b394263cec93e66200782588a7b030b4fe3c7c5632f97e278f1b3101917cc79d6921fb528b51a28d18c4e68859460eb1b90afb0ee47a4501e172ac3db2953fdb8d44bf8388ca4d8fe71b1cb81b3c2a6a1959b5ca5653319b2fcbd8996cc0eba2d9da1014158a3a4408f09cfb58de53c2c8563b7f0f490aef0880512b76b652d27d3a02b3cd25919ca8a6eb48d0c25df695bf177fa4ff0c4f553b85887f15cbc300dae13f0f333db9c98e02412110a14c8f49f948156d81054e652070ff7b6fb2105afb6c2e64fca666594425cfe544c00aab6062345733eb4276cba97073a9e60619949ffc07f4c1dab8988fcb86f97afed77381baf88f4d2d1d6d24e0c612498eff49c7dcfd94c194ec806f66f2b9c7037cb1c74b4d7aa48dd37f48e666c47cf2622a0d70106b9f72845d8a926d48609326571a9f6b608a2565817c9e0df195f428a5c0712f319a2449ffe8af82cfd999eba3fe91cc5b4b2d3c4517f5bf7a3a791d2bd0b8bae244c4eb7649ba5333a72334fee432aafa56a80974795c247cd03baa883ab08f4464ef072dd64724e0d5ab0bf0735ecc103feeb3b71379dc0ebc10def0fd64134775a5e03bca237914f747d00c038623d71244b794cce9ea8c7f842982018532cf8915a449dd2865508a52a80d04ce5c08dd3fbd826d39fcd9d8d793faa70f7d895385a29cd99d1fe346fceacca009c77f982372f6d705f975a5874d08b0037af0d1f5ba7bac712208250c314019073dcb79c6caf69a2e7196fd2f95f68d4bf7ef75b85c5d98bf55de7a21f894a39b22eee79a0f11df6691bcf5dc58e49d8376c416bb610be3fbaa976fcd177744e92d945104fe150d3b5bb2f4ef9051cd01249dee668f694a5759d33cdc685d831622a83ad6212cedc2d8c9c0d6e07e1e3b5313c2ce281d2d4b203d0f5f3b13ff9ad082d2d3434463fdb041a809254ad970ceea498ab4024cc038ee4f4678053520c906acc819f238db031021e643d7bd48a6d776632f12cf7596714c63c7937dbb71245f3a0efc6f15148889436deee407fa47efc2bd3b51d4484bbda55668d378f777a66b25aac16703125707354943677ca6e553ae4ee551cb97b6c30c109f846126784d90357d71f28d79f389432a8c4ed1020ae010837c4411ea5caf77f2ae3742ff5e33de4b686311cc6cf6a376cbbf9c26c139616aeef2fe9551dde45714e1d9cb4108800309d3dbcea455e6ea811067b47e0c54ab50d00df78607b4e125cd744d8005444b9088588d9afe8ded641d1be98b5574b63261e3b422d111ff7f1e3287991f7d3cada80ea7361c15f18aba43321da942a354aa379e297d8be3c83a2132c4f6ddc6abff5c1e30b65ebcfeebb5b1347783672e66485f9586270bb067441bf6bed79e595a619f69e5599a439a1ccd724991f3b3f93e8e34f51d31835952d60cf091f0fe20d2f9957397924a1c552471d4c26475ffeceae8ad517a96665602ae3c8ee629e45e5de36dca708bfd9bf8a52b7d4c94c859428c09f32c07660012850f19873b914831dae0f3454b4724b6889f9a87e8e7579a7ea67debefaa42517cc91200fe00a63c3847c094e1bacdfe88107f78338f2f0114f9782f85cc6a63aacc4eded74fcdae10c6e412ab41a1995e02569ca9246f2b8a9715598e9849bcf043f911f4e96ed19e15820ef6932d715e95d1f64a072e8f0bc5dbd78fd75a42ed8dd0e2727f45370ffb7fcd9222ff4b436e17fd1acf93f28f5252bf16c5c38297fedea73a1ca578c0afa66ce9110d8d02f4447ec38a41647c80ddd6b82f7913dbdfeede161d68a57a3f96279a9dcd676fec1affb20444296aa30865c70b1ea218b7dbb4cb73b86816e00ae2de40912bb3b93bf2a074b7e08c06bf17c7f15c2c44b150518e8fc3b4d7ea42742b790aa5fdef07d07d33e7c5a554c3f841f34b1dc77db89da553de72db0e079973d4011e7d1e5673f980d88275f03f87e9b5c91034b18caafd7ef55253ec1439a8faf42bb36a2894208880d4e391bc11282fbc336db17673820439483e654093fc0200cfd32a3dd9f8940e1d9f34f1af999f6282cd4c86391aab93196a7ee5fe11431aadee67ffa2aacafe40a6e11deeddbc67c3c0b56f06bd41997c335e9f3f800aab98a1dc4d963acecd5283cc931f43a436bc843d3a08ef51dac5e35e00e7d5085fbf6cc927afc01eda09ee24abe45ab1c3325a406a7c753cdf62074ba5041acdd273c791183e1379477190e482c0a5b2f29739237795c9bd6855428b3f375f1108b809306dec5669bb81393d9caf58f9f1311b13871c0328c58da50c54ddba4d68f699108944638ad3c75b6a9508cb6bdfb778abc804d3462294712b4b776e3ee24ca79b0d1661495d54f74cd4e48171474f202f117c598b8ecb4c0ce00625a6e52612e47eab36cc9d6a03dc9ef0766b3947fdee411ec8009cfa05413e0644148eacd3acef4d92642dfa54ecb177f326997a837777c5aa76ee57c59a0416bd1dfd05c62e325ea5f4996ad5cd6bb305f9ce7002bdd424d2fb69bfe705e9a7bedb83681eaa644dcf51f0529fb97c65a3d5672776ca884a672dd01c762cb151ecbe548b62ebf1d5cc2e4a061ad2baf60bc61e26d1ec71381a8b2df69b8181c47775992bcd72e479adbee95c6bce6806528fdc52b64fa7d8c34b59fb73532aabbd647c166180f21a06a725e0e42245104d8975737e9b168b9c220e542882005de550849e810033c3dd14fbb53e4e0f09574a8cfab2cd830d6a44f24c62710f8ec179c83cca698e338a0b33d88e1076e679c238401ee8ef18b07ad8d3939c5cb819f90a8c42b403e36698b27f1fff0bee691ff92dd29fcbd20f4d812903b986039b4e8696bb7441a55695a5941caaa0bc9e876c7b3aa0a20cca30aee18966554ccb30a5d51e3f512cdb81eea4718a0d47e8b27674bcfd2c4b099c4afd83029739c88429686f2777a155f3a2ec054e6707e28d46a6da7a85c33e3ada33f1c018dd749cdbeb426ea89c11272af886736fed5577e3d298534bf6845ee2be0b65cc4eb81c6d23950cf382171f6bcb788a4d7e48d8f3e6785a41e4d4e1de30100824e2002aface154dc603ca5285194dde6c9d26d7e0e62a09990ca2eab55725a815c52a33d5e0e6bc356d1dc197455e787ace04deb307578dc693b3cf241c6cb1fae42d81384685d7583c40bf3336219b2f95c26dde7df472ac729b1fae71fff1b0addac9797e21dc7b4863dc79c4256f0165d4d06e0e7e988449bd0399dcb423d54bb9abdc039fac2bcbafc95a60b4b7421d47f95d7ada6586713e57a0524d995c8274a8d0acb0a1e9b7be2e4851fd010d7edc5d2e224ab579c989bc45e72536612b0407a56a606286b8f46425ababcf99c61d6aba49a296c4b0b6abf343684e29c98d3e1ae4f02120df5d92e05467967beec36558cc5e7f9b026f19a2e4bf9ad47a65d757724040c6a6ddf225cf8c7e5babd1c9b5b70989f946f5a6f0682d4b5cec03c076bd55aea52769854ea5ed0ea7fa64fc0b976d41c91bb575eace1f83cf4353764317e5672dab16c4ae41b2f300f818fe82180e7680e44ee49812b4e4f634bfe2bb7181e9ac155ebf143fe7289d7e4bb9aae3f287d4e303cd3ca4e6c51844bf2380a630f220da2604387cf8fd38adc5d8c26ad8bf3d360b915558a32228b6f30989fcb8eb9b6ffba100f78f0f724a5e70284baad59d5c7339e4e2da3cd4b72d9802adea291fa529953903e933ddc3da08077e149253c4ef3e38714fa389094bbe69c7da2ad7c8b5229a9912579309ec3250225dc2bdf86afb17d68b30244b4374af09a64976f13e56022013501cd42ac7a71cea554d921c79441772f52281bd6c07840f1cafeed38a5ded8ecfa75c5c308bb184f94e3e63153992d6459dfa479a714a494514dac9b7e2be1b1597811bbad1690a54ce00641f894b1bba6c82cd3cc30781b29329798a44997cc17fe9b6a344a30dc2aa6775d91932280e511cb6ab4a5d538428d5e87ae8fd10ab4922219f9dd918468d4b83ff3ec1af03fad1f3ee84b69edc52708a66dec6a25121481362abcabb4b1c6a949300080bfaf0fac490e4b21d07e9bf6d8ee149929910760877df08fb1343f4b6e173a20c047280c328e9d5c5493a222b472179634c00379c2c9a16f1b9bd7d13a527a825ed687958fd9c72ce3dded51921626c92a3fb74aba7aa907c71e6f706b6bcbe5118ff551f4b1bc00261d3b3ea4e22c9a5956f2d535d51c031dc5d9e5f7bc181252c8340960e987df94ac66576ef800a792ee2e9844ddbc18dfe5010e96871e926c980ddef2bbd1c8f768c9d355df4db02dfe9db7c3d9a2ab384c7e56dd9fcfbeba9c562809602e9d19a041fcbdd7831662e505a595e48906708f2e335f9272e789142047519a10028dc7c92d3e6adcf54b522ec897d4b8a6730651ea77c40d1ed0ac2a4d0f0b928bbe37dcc65f7c60a4440bb41dd21f6a6149df2537c98a712945f4610cbe52cc8b9d0fad284158ca7cfd8c860176faab4dda4304b1e451c0f1bc947ef711d0567b268ce7099674852c8cfbbdd4633234f459a4a8cbf071eb1d49537426aa27f2e0dc84870f5b474979455a3a6b93e492e2642598a49ec0c4293ebe809156f33548a1cf7d05469928de9daf64b9777f94ab738ddd4aa60198281595b56930c57c502a9a66e5a9903845ebbeb6720b8bdd75ad0eb42067e056515a24e504f2f0fbf514be0848b260ef15c3032d5411d766f0613ddf6e56dd7206c552f7ceaa85d4cbf1df30458bdeba217ce3249a98395fe452d3c059b12855b82d130d037c3ee45ab11c840f1eb99c75115c60c45feb185a4ae42d58a0853fba8ea07bf8c4b34e6a0a6e82182ecd6e9712a2d19145bb1b4896affa72ec2a3d6b531f311a2fa851e4bfe97b139889232ae23693ac3b8305d40ba3b85d1c4ee3eef8ff674db536ac110e53b7a429b3db3898de56a933c53a9d16ba2286a37b95289eacbc89abc731aff2c6aa0743bcf09035303bd3f1fdbb779c790ac2da16685997333b09ecd8894a13e52979de46e01e3ad3103433b43b0fe0499eb09e0b924d69e75eb770d94519a81a86edbf57a69394d899b84e02862b8a24fc6d5893652da7a8feb8971769ea913887443962a93697522a621568ad2b96bd586e2ba8a3cbabcc37990e5a5dd0be90bc85e1af3da4ad444ac885d1dd3db30d5c19edf928ade160f37b045870dc44e95b318b6c553170f2ed9b5d424884a8c3e55e98b4f3e92a3671b1b0fe943052ca3e81af4c2bc3efe45bc9aab3ed66e08b379002787c567f21c6e080c6c8c801da5acc42ec737466b673262c19bcada98550bc05c126aea56b78f523f5ee60c12cedd4f45c6f4bfdbb157258b2cbd6d423b2c4c80092ece7a01e9ed889c2709074d4505016dba88aec44c4f354bfbabfc3582c1a02e4b1d8e2a2f860c55cd3b7a5baebc1776c4395d11e34d2e6a14ba407079185a30a4d349befe87bd3a8cdbe544161f6ee8dd906706d9d86ffae383f0fb1aff69a28cd39c8e270272b333a3e5bc8dc434d6197c15b9a9e4663979ef31a3f535479ccd1edf4435fcb013f4b6a8e98c52c4a4ca6b5c0caeffb0000000000000000000000000000000000000000000000000000080d10151e212831"_hex;
    tx.chain_id = 1;

    const auto rlp_rep = rlp::encode(tx);
    EXPECT_EQ(rlp_rep,
        "0x02f91c48018302075580850350a3661c82753094535b918f3724001fd6fb52fcc6cbc220592990a3880104a0c63421f80380c0b90a2001727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9b911f334da899b3c5d5ea3a110ec6acfd6388ef9a7f322758cd5b641dd2d838b33eb17103e7e6df7d2f0a3aa019e9a65ee8cbd32a44a15717c4c2f1c1e46b6c8ff1543ef292905f50b2a781eafe151b588f29f54b79f76eee7fb46ca37158e89f8051caa5591af5c12affc28dbbc58a9a587a5fd5b439fd0c809af864613bb789f1978ef7f822f806bdde4103722e251b77d1b662ea4e4924436d22508b94c3239433caa6d1c2ad24c6ad34dc6c4b53054967cb3f3a71d948aa80b1825982c3e7a4790326d28c0ee270b8d475b434a5f9c2caa6e1358dfba4ed631729f37b35158364df2adb9540ee64e2619b050e67d2b9c008f4eaae36a0dd28631f7629e28ff835d769b9b78d733d8e621643efc79496afc4a3dcec6b726e89ba586d0944e1c32b5992d0cc19acde76ec383e3d707626aaf4df869ff0702f03af8aedeffd41f22819eb6fd788ebb0e54165dc940e5601d599dcb3c20d52e5298a215e4a4519dc51b6ea6c305f5778722fe09d4f9aab844993a35ef8b2ffc72f1f26cc715abfa9c420ad2eb6606b29c39a1cdd7dcba3320e29d19d2cc2ee768a2db1f64728dbc768075541dda04db2e49f54bf57ad096c8bc72a44bb96cf7798cb11ff329c82b9185f0b638649b440717721e6fca5eaf92849547f96d1051c6ed873c46f497673ea6cc7a13887601ab581c69bcd57760917fecd4e52ac07ac7ba40a3a1ef6421160c99971a7bce755c02d7113321c5ffb568a1044b26aa9c2cab7c8fcf1b5a3db840d95e7744dee180075aef2995202185ffc01f6d2da6a923f30f6aed2179e053930aee64ff00d85e644690283de5ce54ea0e0c2ee07823152ed3cae09b394263cec93e66200782588a7b030b4fe3c7c5632f97e278f1b3101917cc79d6921fb528b51a28d18c4e68859460eb1b90afb0ee47a4501e172ac3db2953fdb8d44bf8388ca4d8fe71b1cb81b3c2a6a1959b5ca5653319b2fcbd8996cc0eba2d9da1014158a3a4408f09cfb58de53c2c8563b7f0f490aef0880512b76b652d27d3a02b3cd25919ca8a6eb48d0c25df695bf177fa4ff0c4f553b85887f15cbc300dae13f0f333db9c98e02412110a14c8f49f948156d81054e652070ff7b6fb2105afb6c2e64fca666594425cfe544c00aab6062345733eb4276cba97073a9e60619949ffc07f4c1dab8988fcb86f97afed77381baf88f4d2d1d6d24e0c612498eff49c7dcfd94c194ec806f66f2b9c7037cb1c74b4d7aa48dd37f48e666c47cf2622a0d70106b9f72845d8a926d48609326571a9f6b608a2565817c9e0df195f428a5c0712f319a2449ffe8af82cfd999eba3fe91cc5b4b2d3c4517f5bf7a3a791d2bd0b8bae244c4eb7649ba5333a72334fee432aafa56a80974795c247cd03baa883ab08f4464ef072dd64724e0d5ab0bf0735ecc103feeb3b71379dc0ebc10def0fd64134775a5e03bca237914f747d00c038623d71244b794cce9ea8c7f842982018532cf8915a449dd2865508a52a80d04ce5c08dd3fbd826d39fcd9d8d793faa70f7d895385a29cd99d1fe346fceacca009c77f982372f6d705f975a5874d08b0037af0d1f5ba7bac712208250c314019073dcb79c6caf69a2e7196fd2f95f68d4bf7ef75b85c5d98bf55de7a21f894a39b22eee79a0f11df6691bcf5dc58e49d8376c416bb610be3fbaa976fcd177744e92d945104fe150d3b5bb2f4ef9051cd01249dee668f694a5759d33cdc685d831622a83ad6212cedc2d8c9c0d6e07e1e3b5313c2ce281d2d4b203d0f5f3b13ff9ad082d2d3434463fdb041a809254ad970ceea498ab4024cc038ee4f4678053520c906acc819f238db031021e643d7bd48a6d776632f12cf7596714c63c7937dbb71245f3a0efc6f15148889436deee407fa47efc2bd3b51d4484bbda55668d378f777a66b25aac16703125707354943677ca6e553ae4ee551cb97b6c30c109f846126784d90357d71f28d79f389432a8c4ed1020ae010837c4411ea5caf77f2ae3742ff5e33de4b686311cc6cf6a376cbbf9c26c139616aeef2fe9551dde45714e1d9cb4108800309d3dbcea455e6ea811067b47e0c54ab50d00df78607b4e125cd744d8005444b9088588d9afe8ded641d1be98b5574b63261e3b422d111ff7f1e3287991f7d3cada80ea7361c15f18aba43321da942a354aa379e297d8be3c83a2132c4f6ddc6abff5c1e30b65ebcfeebb5b1347783672e66485f9586270bb067441bf6bed79e595a619f69e5599a439a1ccd724991f3b3f93e8e34f51d31835952d60cf091f0fe20d2f9957397924a1c552471d4c26475ffeceae8ad517a96665602ae3c8ee629e45e5de36dca708bfd9bf8a52b7d4c94c859428c09f32c07660012850f19873b914831dae0f3454b4724b6889f9a87e8e7579a7ea67debefaa42517cc91200fe00a63c3847c094e1bacdfe88107f78338f2f0114f9782f85cc6a63aacc4eded74fcdae10c6e412ab41a1995e02569ca9246f2b8a9715598e9849bcf043f911f4e96ed19e15820ef6932d715e95d1f64a072e8f0bc5dbd78fd75a42ed8dd0e2727f45370ffb7fcd9222ff4b436e17fd1acf93f28f5252bf16c5c38297fedea73a1ca578c0afa66ce9110d8d02f4447ec38a41647c80ddd6b82f7913dbdfeede161d68a57a3f96279a9dcd676fec1affb20444296aa30865c70b1ea218b7dbb4cb73b86816e00ae2de40912bb3b93bf2a074b7e08c06bf17c7f15c2c44b150518e8fc3b4d7ea42742b790aa5fdef07d07d33e7c5a554c3f841f34b1dc77db89da553de72db0e079973d4011e7d1e5673f980d88275f03f87e9b5c91034b18caafd7ef55253ec1439a8faf42bb36a2894208880d4e391bc11282fbc336db17673820439483e654093fc0200cfd32a3dd9f8940e1d9f34f1af999f6282cd4c86391aab93196a7ee5fe11431aadee67ffa2aacafe40a6e11deeddbc67c3c0b56f06bd41997c335e9f3f800aab98a1dc4d963acecd5283cc931f43a436bc843d3a08ef51dac5e35e00e7d5085fbf6cc927afc01eda09ee24abe45ab1c3325a406a7c753cdf62074ba5041acdd273c791183e1379477190e482c0a5b2f29739237795c9bd6855428b3f375f1108b809306dec5669bb81393d9caf58f9f1311b13871c0328c58da50c54ddba4d68f699108944638ad3c75b6a9508cb6bdfb778abc804d3462294712b4b776e3ee24ca79b0d1661495d54f74cd4e48171474f202f117c598b8ecb4c0ce00625a6e52612e47eab36cc9d6a03dc9ef0766b3947fdee411ec8009cfa05413e0644148eacd3acef4d92642dfa54ecb177f326997a837777c5aa76ee57c59a0416bd1dfd05c62e325ea5f4996ad5cd6bb305f9ce7002bdd424d2fb69bfe705e9a7bedb83681eaa644dcf51f0529fb97c65a3d5672776ca884a672dd01c762cb151ecbe548b62ebf1d5cc2e4a061ad2baf60bc61e26d1ec71381a8b2df69b8181c47775992bcd72e479adbee95c6bce6806528fdc52b64fa7d8c34b59fb73532aabbd647c166180f21a06a725e0e42245104d8975737e9b168b9c220e542882005de550849e810033c3dd14fbb53e4e0f09574a8cfab2cd830d6a44f24c62710f8ec179c83cca698e338a0b33d88e1076e679c238401ee8ef18b07ad8d3939c5cb819f90a8c42b403e36698b27f1fff0bee691ff92dd29fcbd20f4d812903b986039b4e8696bb7441a55695a5941caaa0bc9e876c7b3aa0a20cca30aee18966554ccb30a5d51e3f512cdb81eea4718a0d47e8b27674bcfd2c4b099c4afd83029739c88429686f2777a155f3a2ec054e6707e28d46a6da7a85c33e3ada33f1c018dd749cdbeb426ea89c11272af886736fed5577e3d298534bf6845ee2be0b65cc4eb81c6d23950cf382171f6bcb788a4d7e48d8f3e6785a41e4d4e1de30100824e2002aface154dc603ca5285194dde6c9d26d7e0e62a09990ca2eab55725a815c52a33d5e0e6bc356d1dc197455e787ace04deb307578dc693b3cf241c6cb1fae42d81384685d7583c40bf3336219b2f95c26dde7df472ac729b1fae71fff1b0addac9797e21dc7b4863dc79c4256f0165d4d06e0e7e988449bd0399dcb423d54bb9abdc039fac2bcbafc95a60b4b7421d47f95d7ada6586713e57a0524d995c8274a8d0acb0a1e9b7be2e4851fd010d7edc5d2e224ab579c989bc45e72536612b0407a56a606286b8f46425ababcf99c61d6aba49a296c4b0b6abf343684e29c98d3e1ae4f02120df5d92e05467967beec36558cc5e7f9b026f19a2e4bf9ad47a65d757724040c6a6ddf225cf8c7e5babd1c9b5b70989f946f5a6f0682d4b5cec03c076bd55aea52769854ea5ed0ea7fa64fc0b976d41c91bb575eace1f83cf4353764317e5672dab16c4ae41b2f300f818fe82180e7680e44ee49812b4e4f634bfe2bb7181e9ac155ebf143fe7289d7e4bb9aae3f287d4e303cd3ca4e6c51844bf2380a630f220da2604387cf8fd38adc5d8c26ad8bf3d360b915558a32228b6f30989fcb8eb9b6ffba100f78f0f724a5e70284baad59d5c7339e4e2da3cd4b72d9802adea291fa529953903e933ddc3da08077e149253c4ef3e38714fa389094bbe69c7da2ad7c8b5229a9912579309ec3250225dc2bdf86afb17d68b30244b4374af09a64976f13e56022013501cd42ac7a71cea554d921c79441772f52281bd6c07840f1cafeed38a5ded8ecfa75c5c308bb184f94e3e63153992d6459dfa479a714a494514dac9b7e2be1b1597811bbad1690a54ce00641f894b1bba6c82cd3cc30781b29329798a44997cc17fe9b6a344a30dc2aa6775d91932280e511cb6ab4a5d538428d5e87ae8fd10ab4922219f9dd918468d4b83ff3ec1af03fad1f3ee84b69edc52708a66dec6a25121481362abcabb4b1c6a949300080bfaf0fac490e4b21d07e9bf6d8ee149929910760877df08fb1343f4b6e173a20c047280c328e9d5c5493a222b472179634c00379c2c9a16f1b9bd7d13a527a825ed687958fd9c72ce3dded51921626c92a3fb74aba7aa907c71e6f706b6bcbe5118ff551f4b1bc00261d3b3ea4e22c9a5956f2d535d51c031dc5d9e5f7bc181252c8340960e987df94ac66576ef800a792ee2e9844ddbc18dfe5010e96871e926c980ddef2bbd1c8f768c9d355df4db02dfe9db7c3d9a2ab384c7e56dd9fcfbeba9c562809602e9d19a041fcbdd7831662e505a595e48906708f2e335f9272e789142047519a10028dc7c92d3e6adcf54b522ec897d4b8a6730651ea77c40d1ed0ac2a4d0f0b928bbe37dcc65f7c60a4440bb41dd21f6a6149df2537c98a712945f4610cbe52cc8b9d0fad284158ca7cfd8c860176faab4dda4304b1e451c0f1bc947ef711d0567b268ce7099674852c8cfbbdd4633234f459a4a8cbf071eb1d49537426aa27f2e0dc84870f5b474979455a3a6b93e492e2642598a49ec0c4293ebe809156f33548a1cf7d05469928de9daf64b9777f94ab738ddd4aa60198281595b56930c57c502a9a66e5a9903845ebbeb6720b8bdd75ad0eb42067e056515a24e504f2f0fbf514be0848b260ef15c3032d5411d766f0613ddf6e56dd7206c552f7ceaa85d4cbf1df30458bdeba217ce3249a98395fe452d3c059b12855b82d130d037c3ee45ab11c840f1eb99c75115c60c45feb185a4ae42d58a0853fba8ea07bf8c4b34e6a0a6e82182ecd6e9712a2d19145bb1b4896affa72ec2a3d6b531f311a2fa851e4bfe97b139889232ae23693ac3b8305d40ba3b85d1c4ee3eef8ff674db536ac110e53b7a429b3db3898de56a933c53a9d16ba2286a37b95289eacbc89abc731aff2c6aa0743bcf09035303bd3f1fdbb779c790ac2da16685997333b09ecd8894a13e52979de46e01e3ad3103433b43b0fe0499eb09e0b924d69e75eb770d94519a81a86edbf57a69394d899b84e02862b8a24fc6d5893652da7a8feb8971769ea913887443962a93697522a621568ad2b96bd586e2ba8a3cbabcc37990e5a5dd0be90bc85e1af3da4ad444ac885d1dd3db30d5c19edf928ade160f37b045870dc44e95b318b6c553170f2ed9b5d424884a8c3e55e98b4f3e92a3671b1b0fe943052ca3e81af4c2bc3efe45bc9aab3ed66e08b379002787c567f21c6e080c6c8c801da5acc42ec737466b673262c19bcada98550bc05c126aea56b78f523f5ee60c12cedd4f45c6f4bfdbb157258b2cbd6d423b2c4c80092ece7a01e9ed889c2709074d4505016dba88aec44c4f354bfbabfc3582c1a02e4b1d8e2a2f860c55cd3b7a5baebc1776c4395d11e34d2e6a14ba407079185a30a4d349befe87bd3a8cdbe544161f6ee8dd906706d9d86ffae383f0fb1aff69a28cd39c8e270272b333a3e5bc8dc434d6197c15b9a9e4663979ef31a3f535479ccd1edf4435fcb013f4b6a8e98c52c4a4ca6b5c0caeffb0000000000000000000000000000000000000000000000000000080d10151e212831"_hex);

    EXPECT_EQ(keccak256(rlp_rep),
        0xef11c7b1d598089180912d9b0a76cb80245e61bbb4b2176627510bcd0d96f43f_bytes32);
}

TEST(state_rlp, tx_to_rlp_eip1559_with_data)
{
    state::Transaction tx{};
    tx.kind = zvmone::state::Transaction::Kind::eip1559;
    tx.data =
        "095ea7b3"
        "0000000000000000000000001111111254eeb25477b68fb85ed929f73a960582"
        "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"_hex;
    tx.gas_limit = 53319;
    tx.max_gas_price = 14358031378;
    tx.max_priority_gas_price = 576312105;
    tx.sender = "Z165f65c2985c4564b13fed095e35cd00abb8084ea6df59a4"_address;
    tx.to = "Za1f4980170a07e780199cfcedc8a4c945915c8f7e7cb7841"_address;
    tx.value = 0;
    tx.access_list = {};
    tx.nonce = 47;
    tx.public_key =
        "01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"_hex;
    tx.signature =
        "9c9045df70ddb0fdbd0f70657120e474cb616ec3a0a57cdf564543faf1f1986cda1c7589cdc83cf33f64040243b5e935ef026dea3947c077f741176a379ba5bf785aa3d6c6216f1afd66552ba98af786fa18f3a72139c3274c21065bf808e596447e1b94877922ade23c1a3bcd05b6ede444a14ffdd2cd03a75a3c5ba56d4de1bf3ad29bb3e9b90f6879553131d401f02ee7183a87b8e5a40b8ee5a9b5a93979843dd05f8af844e3bced42b1f412079d9c893d3c7195acbfe744bc4bb9655b268f778c82e5545c9407cf876cd343b32d724f96a54bc90d4fe68e8a8ce7e9d639765b68acd5c83aef8d69d05425f7ccfcc7f00b87f92a31f983b5ab105e753727580a8e18cb5ddc0d3db9f1ccf8ee7d2742a590b2924e0ca07cfd9e44935820ced21e5d72c9012be3eff71807f6fc69818eba19c8f0908d7b2304d6c044821e0f7fd8bcbedb3abb25026dc36023746ad2903ad8159034d01dc7c13151ec87ed3e26a4735b3faea496c7b015161a6f2c87aa6caf514e557451a7f7c5a32366051f181cc96114051fa9c999dc4d0d7347b8ebb133c714a4ae267b4c9a0285c1e26f4ac10a15a2caccb1ecd3089d52b036c539de1118fd31b3fe79ff5ad859098959d9b8b2f76cde0c4908e64f5992b4fbb600db01c86abce80e02371945c06e089da06c5dd27a98e1e6094f23d616fe0d8641463cf8b5c27080c12499e356ff7d8658633cd2b4789e374b1d8e76853ee66fd9963502d1e9e4171715087c4b795e6ab2783bd0894e0ef5dfb037df93a5ef426c35610901a6b767cb3ce572322dc899f9f0b2fe125ebd452cc285da306f91456831198c2e650f67c5a828d6d247f97fbc8046560c728b9a66f2ae938fef26ddbdac6f764b23daf08658dad20283e7f152f83c998c31b4bd5df278662c3cb87aee4ac495e22a3e5ffa3ecb39b9a844ed5c28d526c8c8d5944c0e68f22a2059b69a81cf0fa52370a57d4ef5188f9bf9ed261f7c03d65fbd77b456a1278ddca903f82d64d1a2325b7c464d16e901597a8cec454ffd6e4057fa3076c4b156d84af24b014c6c6bf573e39c4d030cece12b25282e9642b6d3f9f78201f510353b21b61a5b68cd6a97534cc8cdb66ce1b94c0bf75f6d18b1b13fd921e98e6d6590404ad6a087639ad4723cacb52bf0c425de78014fecd7316b7f221bd13902e8f5443587d2381f3cd0047bb97a14013fa527f456f878ce48f9a38505a4860bb5dca0cb7295fb60b780ce80353df0ba30093e1278f5586a23f9f99476601e3b6a5eb05c37b609e5c968bdbfc40aaec0ed20a361d55c99db5c146dff9e8e4beafb38f8785bfc5b737fe2a92535e2a21d5fc9b10fb4c1fa39f6d5840b1c1af00ba23f2fd9c0d2a9f296057a043dc138b8b11e46c554577e12ba298b91c25674dcbea69d0266af58b4f462cc9b21c52a8e31cb7ba8ddc7ee67ef9099a5b4c228f2d17debe66596dccd1f00751507844fe74870900eb0505b5595a209fd5c19063474442407e22121ea556866e5ed89043cae383f7741e86218450ece13784f16272dff7a027290f6b51f4382244707972a03ac3e24a947ddccdfa07769ce17386c7f6a632155e53e552ff2606460f5d402ea11ff27c21b06a50040a4f5bf28aa3e5bb874526ada7a32903e23360d7928c2f2bb5279801436625fb730399c9b3746d0f4c04055fbda72acfc6926bc872155909bcbe685959d435abac0ddb4d45b61591843a43353e14f65b6c624e9399f9df6fbf374de9c6ff4b8bc8d444c83033cff264a6d980fc4f58e4fdfc8bf29fe7f456b00ed719870976facac323d38feb9c35cce093e84cbc725508740477d3fd67d2d4f2e6cd24b9708c0c0bc8fc9fb611491309cc88644d9494e434f91320c075d67af9ef8b8b7d192fc449b262ff43fbd8f51ae7bf476feafd083019c4b670d151d29bcc71a4ce71bb87994601af7d3789655b5dc1f9f40b5da315bc41dc294b04cabf43bbe0891ba94ee469fcbe761164c62726b3409277cd2863ed809219178d1339b901946f9e2c1776ab697af65663236b7149742c66fc6096db46b6ca03f8c0e6cfc8ab14a8512f85ead310e30e7f7a1243d48b8f06a0d3e7e0be2394b49d609173821b2ee9faf7636fc41a65264e13493d57040860947d13616ad648fb535ae0a472b563784313525692981d2eb698e9f0aa62375314c1219951d81aa1f2424c9773df7d44dd366b45f00568cea3b94bae0329c5404de65c44b9c01886543e85943154749f9c9e0c2a6286602e985e62336e63196bbe6acc300a6d8b0e7435c8e4112c87aa781052ea9c1b69d0a24d769a0a5e95da981899da1115c1a7dd9f3b7419a89c22f7cd001b33997af9cef5dab1c65cf687a49d48113fc281d5f290a99864e0d0bc8d9135b4300e2927de7c7bcfb070edfb7a7629691f5f5ae1c8f3a6bec1af426949044d848c618205a00a3ea61b9c493649107c0a238e364a50cd4b4a7502e1bfe94f57d11b070d1f700274a8283f841d01d09f070357dee67dcc00dd107ebe478419976b53494430049b6a8433922f63c2d4b273cfccfe6a81bff737366ee3c0bd27cdc7ef92bd6c4debefb0844c771aedf23f1b939354c6fc5adea4bb63efa77a37bd97ca5980ba511e5d82b139d2156dbbfece341915dcefeb019218c1bb301f6564fd4dd6777a532fe4001ac2fd0bea8ab556b18200549a44de72682596180552d7f8c0c6dafe6e0fbbcbd9076b7a2069f221335b575886c43eed13de5f755f75c7ac7c7b31dc00f1e07d8f329c3afb66ed674489791b6cac5b8d5bd89fee46dc4e351f64e540ea8eefc33168fca1ba5afa920a81a60f4da990ebed5f5d2c3576e821fcbeab5364d502f549d4210cc903df361749e933d0c969570d3cb95669d240562d908d983ce4bcc5c3c9ffbe67fcf10dacff45b078c2bd6851fb4cf652ea969fb49f186b65e1971a7029a0d9c07a65c46226eec6f542ee26de5fa66a1a9278b594f407963d166d1b5e5ff735512587986cac033a2f12ed5466ffc8fbf44290f4762903f2c43aa62f8cc3d83b3f85756ed5800f1eb0f50b93af0250c02f9107ad3680f560691b307571a863c444e390773495136b00c730548e602d51ce4b5ecefb2edc3b237ebe56b1de9c6c86589269441bc0fcea8c254b735def97a218a7435acb035908166c1fb6c3a6abe684632cb07279bb0567602c9774ea4a5ae5590199e34cd9a67f963b32e3ae74ac568c70280acd728a8d0237c423b32bb63b5bc86f1dfda1ebe27ae84798067a63b479968d4c6043be93a08b4cf4f20406ea99e5956440035e0e9055c86584a643be80a6b8cb94b9211d55d4466fe89fd55da10a24cd13716022cf1227bf8be6c4c3d0470fcd2469f5b4d5b7ea82d2dbb327e2f12ce6254c953838b44f4e30e67dca7fee0e2f935a26e4abb08bdfe9efb573f289de8d4149e3b2b784b345489a5c46e968f11f071d574339cd9b18099bf33c032c37ee131fedb148f86111b43bb728407a3472e9ce3cdeb4937d0b066fed1e819ab9ae1b62ba3261cab8aee2accd4a8fa40f62681decf760cc7c1ec7280aeb96dae9520406e92688bd7d147fa4264c4f56c32d6f5053d8101b435e433648f0dc15b0557fe55cbf1836c25e403952eb957f83c51de7db597d2f060ff038c645d454d4e8ae04fc16e44b023a8c09dc6e873a859c60767c2eaf17456d61463c38613aaa43884c6ec19998acfb9f227f89f8abb70c7c255e32e509dbec987364040ea328012cbba89855b9f5f7ba1efef4dc3cc210931f28a59e5c92789b418a784f1a6115d189a4858f15864fb7ac77029e1cee6bafb0de02bdb040f1df242398ad5be95b69f0d5bb6b54d2f9c1878b56978310f85df047d424e384ee79afa0304d43e90118b72ed8d97030e4a32eb2e96c007c519e5bdb168c91ebf844c99b9d6f746ee3c87cf6e36df9c972a03ca682ad03b99218da54b7198cb36b7d90096a18872eb9342cdc56c9f7854c885e57cd6480e66b955b58cea5c7247d80c0107c945fd69cd2a1c5f30c25dee210c6f4b3605703143791cfc5ca2c1fe0e5341b65a48dc374502cc7224ac688d834a832bf2f4c53f591f29d01f51ebd33c3ee235b074fabd439f1dfe55cfeb28a874daec196634e17d62a329f24c21a00fb3307eb0266b2db7423a92795284875c030256161e5b7e1305e86712d944df8d79ae5a414b58cab4111ff9db9ee9df7dcce3e27d2f5329133fa6de98bd54b56ca4854fbcf5a07222af219f3da78dc5a9f8aad88601514246ec3437f848a8bf1f2d745dbf3d0c13fed44a99eb14d21277be1464f7b0babf98fb9957de2cca0658afd3a709ddc44535082da8c79d22cdea5a6c6d0b8066ac3fbec5a97b8480cbd905db03aaa559b5121701f1e69dbc33f07d1036a70fffa5eb1d28172d968ed52ed4fda4f30d851cf6b0b2e6e9bed341bb3518745ea4825c905c5bc826bf63efcf00eaa6be053c6c97a4b70219b5fa411b1d45d38c87681708842b4b034860f2da6f8108646a1078daee90a01d4cd45b0e807b91196418bbaa69da67307ac802e11f97ce0ca94d6ee28264c31569a8ad3408c1825bf5ee5f40f8b4848677edd6cc540ffdfcd0686c31636facae8655518fa9c442cbd2311679cf6f187109ab9482d8037cc3be7085366d99357306ee04174b70edfe0791416d865318e6c2afff3f35f1eb91803c9e5c550b923bbdd07684ed2ec9cca504464be988d440031ea73d6507f878e1b1d5429949fe411036a621b237eb5cf46ed1708999b46569d33ffa1d18af6f4eac22f0c5c55a9bd8f5fed0ac4ba78565f8c70f4c3532e641276102f967eb9e438141772ba9f1913972f2d03526ace4d7cf1206d7d78bef099ef5b6522828e6ea1a485ffc8915b45906a458be7a7de161c475fe2870ba2e08608568b569d60418cc4aae4979428523a19ba46e02ae093f41e955be9fad3d10c0d885dc38199b32c3f65895f9a8ad08f15741a8eed44cd522fddfaafd63acd9f406fc56775c246005c3b0ce46378d02c0e891776b9b60f960cfa6c3961c71d190bc843eebad497b9b566fbce8bf91074f32ab939ec365dc263ce4a9b75e38b44bb7189a455ab05cbdfb4218ca75ea09c2d2430bd97d621dba2610c0062d878f836bd95b034a9ec6752187a778686ace2021aa196dda97186f00d259d8aa05b66ced650d79fe0f17830d2f791013deda17dcc3d2594a74f47a6bc3be4467ebb57e88f3a912dc7f9fbf3a8f7534742c302c4d159ce77d9765b8fe15015954abb4fda8fcb07dd77dd9bb2bcdc34c801487fbc30c2541f4ae1afe370ac24bf6347ae3d235776dcb87005124ea590868e5ff841b681fe6e538bb5f9a518b0a96e3005781443a59332ae3b587f060806acc8d4d35e91002fd7d0f6d56ba1c6e096655afaf511b2a513005448f92037c717e7a4e98ff3a2adf66698c7bd4837feafe54c1eae5b6d1bcff4727a2fe41d57d5c19f297500bcf6afe7f5745c811b86bc7cd805f9da6721d4522976d9e6cac6ce63b1639b9e5a3fb06990649621483f49f5332d2e5304defd03b330bb1c890c66f954bc34fa3e4d70a9cea827d8b661718a46b5eaf16a0e32456d98b88d89def7e8a5c80914c33692bc11df689d163817af49534ffc845170d2c318211daa5828c632450ed9a89e532e5823543cccc50ce81b25f3b7245ab7d80ce0c56583fb050067e7ca86e8282eb4a09842e2c465ce0888049acda15f14f77a65e44a1e3442cf0dab78ceafa53d43eba21d3f2af580aa2c766f382a2e81d9a416543699e974a497fbf0fa5ea4c8eefb516813bc4b0a561315f0896aade21c7078cfc9d5dbb985aa9f97481f94ec47ec0bc74d9d3d990c341aa2a1cf10e78f6c677a1c6604c6934dcdde247a270a02355396a16c8f2eeea2944c220f61838db90efbd3d9589edbb2c53d902a1e1dfb8f506737cf2e73f95b014f0e08642dc8727603943d7558bedf0862a295bb8e15735896d243f4f968c622853768230265a18a139c08dc8b3f295c6211bcb4b58cea5a47effc58576ed88ea0f6841215220c64812b69b80c2beb05d029bd4ea8432cad4a2640180cf3ce4da79a2e56981b16dcc707865d05c7b28dbadfda86292d1dab208a4e90c8a20394a547fe6a4c41df04f21656a9289984e5597dd04bb6f11661f06068a7715eb88e0cf64c3683c4fa043fd5ef0d77bc4e2159cf9693be052746b83f6f10024017b84069ad03e1907e7d646be84aa12ab131f0d7917ad81d43b0e3b9ec0a3db233d0a3d3175bae58548578ea71d55c6f375f303646e41f05206800332da03cdaf711fb30adbd9651025242b28c46403574c595eb6b7ddb650f58b3127d6c5e55c326d898c8ea5acaef921343a5964f1fe404f62ac0921263435365bee3f5563700f2d467293999ca2ff404f6797a3a61923555d8a96b80000000000000000000000000000000000000000000910141c20292f36"_hex;
    tx.chain_id = 1;

    const auto rlp_rep = rlp::encode(tx);
    EXPECT_EQ(rlp_rep,
        "02f91c86012f842259d329850357ce2c1282d04794c02aaa39b223fe8d0a0e5c4f27ead9083c756cc280b844095ea7b30000000000000000000000001111111254eeb25477b68fb85ed929f73a960582ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0b90a2001727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9b911f39c9045df70ddb0fdbd0f70657120e474cb616ec3a0a57cdf564543faf1f1986cda1c7589cdc83cf33f64040243b5e935ef026dea3947c077f741176a379ba5bf785aa3d6c6216f1afd66552ba98af786fa18f3a72139c3274c21065bf808e596447e1b94877922ade23c1a3bcd05b6ede444a14ffdd2cd03a75a3c5ba56d4de1bf3ad29bb3e9b90f6879553131d401f02ee7183a87b8e5a40b8ee5a9b5a93979843dd05f8af844e3bced42b1f412079d9c893d3c7195acbfe744bc4bb9655b268f778c82e5545c9407cf876cd343b32d724f96a54bc90d4fe68e8a8ce7e9d639765b68acd5c83aef8d69d05425f7ccfcc7f00b87f92a31f983b5ab105e753727580a8e18cb5ddc0d3db9f1ccf8ee7d2742a590b2924e0ca07cfd9e44935820ced21e5d72c9012be3eff71807f6fc69818eba19c8f0908d7b2304d6c044821e0f7fd8bcbedb3abb25026dc36023746ad2903ad8159034d01dc7c13151ec87ed3e26a4735b3faea496c7b015161a6f2c87aa6caf514e557451a7f7c5a32366051f181cc96114051fa9c999dc4d0d7347b8ebb133c714a4ae267b4c9a0285c1e26f4ac10a15a2caccb1ecd3089d52b036c539de1118fd31b3fe79ff5ad859098959d9b8b2f76cde0c4908e64f5992b4fbb600db01c86abce80e02371945c06e089da06c5dd27a98e1e6094f23d616fe0d8641463cf8b5c27080c12499e356ff7d8658633cd2b4789e374b1d8e76853ee66fd9963502d1e9e4171715087c4b795e6ab2783bd0894e0ef5dfb037df93a5ef426c35610901a6b767cb3ce572322dc899f9f0b2fe125ebd452cc285da306f91456831198c2e650f67c5a828d6d247f97fbc8046560c728b9a66f2ae938fef26ddbdac6f764b23daf08658dad20283e7f152f83c998c31b4bd5df278662c3cb87aee4ac495e22a3e5ffa3ecb39b9a844ed5c28d526c8c8d5944c0e68f22a2059b69a81cf0fa52370a57d4ef5188f9bf9ed261f7c03d65fbd77b456a1278ddca903f82d64d1a2325b7c464d16e901597a8cec454ffd6e4057fa3076c4b156d84af24b014c6c6bf573e39c4d030cece12b25282e9642b6d3f9f78201f510353b21b61a5b68cd6a97534cc8cdb66ce1b94c0bf75f6d18b1b13fd921e98e6d6590404ad6a087639ad4723cacb52bf0c425de78014fecd7316b7f221bd13902e8f5443587d2381f3cd0047bb97a14013fa527f456f878ce48f9a38505a4860bb5dca0cb7295fb60b780ce80353df0ba30093e1278f5586a23f9f99476601e3b6a5eb05c37b609e5c968bdbfc40aaec0ed20a361d55c99db5c146dff9e8e4beafb38f8785bfc5b737fe2a92535e2a21d5fc9b10fb4c1fa39f6d5840b1c1af00ba23f2fd9c0d2a9f296057a043dc138b8b11e46c554577e12ba298b91c25674dcbea69d0266af58b4f462cc9b21c52a8e31cb7ba8ddc7ee67ef9099a5b4c228f2d17debe66596dccd1f00751507844fe74870900eb0505b5595a209fd5c19063474442407e22121ea556866e5ed89043cae383f7741e86218450ece13784f16272dff7a027290f6b51f4382244707972a03ac3e24a947ddccdfa07769ce17386c7f6a632155e53e552ff2606460f5d402ea11ff27c21b06a50040a4f5bf28aa3e5bb874526ada7a32903e23360d7928c2f2bb5279801436625fb730399c9b3746d0f4c04055fbda72acfc6926bc872155909bcbe685959d435abac0ddb4d45b61591843a43353e14f65b6c624e9399f9df6fbf374de9c6ff4b8bc8d444c83033cff264a6d980fc4f58e4fdfc8bf29fe7f456b00ed719870976facac323d38feb9c35cce093e84cbc725508740477d3fd67d2d4f2e6cd24b9708c0c0bc8fc9fb611491309cc88644d9494e434f91320c075d67af9ef8b8b7d192fc449b262ff43fbd8f51ae7bf476feafd083019c4b670d151d29bcc71a4ce71bb87994601af7d3789655b5dc1f9f40b5da315bc41dc294b04cabf43bbe0891ba94ee469fcbe761164c62726b3409277cd2863ed809219178d1339b901946f9e2c1776ab697af65663236b7149742c66fc6096db46b6ca03f8c0e6cfc8ab14a8512f85ead310e30e7f7a1243d48b8f06a0d3e7e0be2394b49d609173821b2ee9faf7636fc41a65264e13493d57040860947d13616ad648fb535ae0a472b563784313525692981d2eb698e9f0aa62375314c1219951d81aa1f2424c9773df7d44dd366b45f00568cea3b94bae0329c5404de65c44b9c01886543e85943154749f9c9e0c2a6286602e985e62336e63196bbe6acc300a6d8b0e7435c8e4112c87aa781052ea9c1b69d0a24d769a0a5e95da981899da1115c1a7dd9f3b7419a89c22f7cd001b33997af9cef5dab1c65cf687a49d48113fc281d5f290a99864e0d0bc8d9135b4300e2927de7c7bcfb070edfb7a7629691f5f5ae1c8f3a6bec1af426949044d848c618205a00a3ea61b9c493649107c0a238e364a50cd4b4a7502e1bfe94f57d11b070d1f700274a8283f841d01d09f070357dee67dcc00dd107ebe478419976b53494430049b6a8433922f63c2d4b273cfccfe6a81bff737366ee3c0bd27cdc7ef92bd6c4debefb0844c771aedf23f1b939354c6fc5adea4bb63efa77a37bd97ca5980ba511e5d82b139d2156dbbfece341915dcefeb019218c1bb301f6564fd4dd6777a532fe4001ac2fd0bea8ab556b18200549a44de72682596180552d7f8c0c6dafe6e0fbbcbd9076b7a2069f221335b575886c43eed13de5f755f75c7ac7c7b31dc00f1e07d8f329c3afb66ed674489791b6cac5b8d5bd89fee46dc4e351f64e540ea8eefc33168fca1ba5afa920a81a60f4da990ebed5f5d2c3576e821fcbeab5364d502f549d4210cc903df361749e933d0c969570d3cb95669d240562d908d983ce4bcc5c3c9ffbe67fcf10dacff45b078c2bd6851fb4cf652ea969fb49f186b65e1971a7029a0d9c07a65c46226eec6f542ee26de5fa66a1a9278b594f407963d166d1b5e5ff735512587986cac033a2f12ed5466ffc8fbf44290f4762903f2c43aa62f8cc3d83b3f85756ed5800f1eb0f50b93af0250c02f9107ad3680f560691b307571a863c444e390773495136b00c730548e602d51ce4b5ecefb2edc3b237ebe56b1de9c6c86589269441bc0fcea8c254b735def97a218a7435acb035908166c1fb6c3a6abe684632cb07279bb0567602c9774ea4a5ae5590199e34cd9a67f963b32e3ae74ac568c70280acd728a8d0237c423b32bb63b5bc86f1dfda1ebe27ae84798067a63b479968d4c6043be93a08b4cf4f20406ea99e5956440035e0e9055c86584a643be80a6b8cb94b9211d55d4466fe89fd55da10a24cd13716022cf1227bf8be6c4c3d0470fcd2469f5b4d5b7ea82d2dbb327e2f12ce6254c953838b44f4e30e67dca7fee0e2f935a26e4abb08bdfe9efb573f289de8d4149e3b2b784b345489a5c46e968f11f071d574339cd9b18099bf33c032c37ee131fedb148f86111b43bb728407a3472e9ce3cdeb4937d0b066fed1e819ab9ae1b62ba3261cab8aee2accd4a8fa40f62681decf760cc7c1ec7280aeb96dae9520406e92688bd7d147fa4264c4f56c32d6f5053d8101b435e433648f0dc15b0557fe55cbf1836c25e403952eb957f83c51de7db597d2f060ff038c645d454d4e8ae04fc16e44b023a8c09dc6e873a859c60767c2eaf17456d61463c38613aaa43884c6ec19998acfb9f227f89f8abb70c7c255e32e509dbec987364040ea328012cbba89855b9f5f7ba1efef4dc3cc210931f28a59e5c92789b418a784f1a6115d189a4858f15864fb7ac77029e1cee6bafb0de02bdb040f1df242398ad5be95b69f0d5bb6b54d2f9c1878b56978310f85df047d424e384ee79afa0304d43e90118b72ed8d97030e4a32eb2e96c007c519e5bdb168c91ebf844c99b9d6f746ee3c87cf6e36df9c972a03ca682ad03b99218da54b7198cb36b7d90096a18872eb9342cdc56c9f7854c885e57cd6480e66b955b58cea5c7247d80c0107c945fd69cd2a1c5f30c25dee210c6f4b3605703143791cfc5ca2c1fe0e5341b65a48dc374502cc7224ac688d834a832bf2f4c53f591f29d01f51ebd33c3ee235b074fabd439f1dfe55cfeb28a874daec196634e17d62a329f24c21a00fb3307eb0266b2db7423a92795284875c030256161e5b7e1305e86712d944df8d79ae5a414b58cab4111ff9db9ee9df7dcce3e27d2f5329133fa6de98bd54b56ca4854fbcf5a07222af219f3da78dc5a9f8aad88601514246ec3437f848a8bf1f2d745dbf3d0c13fed44a99eb14d21277be1464f7b0babf98fb9957de2cca0658afd3a709ddc44535082da8c79d22cdea5a6c6d0b8066ac3fbec5a97b8480cbd905db03aaa559b5121701f1e69dbc33f07d1036a70fffa5eb1d28172d968ed52ed4fda4f30d851cf6b0b2e6e9bed341bb3518745ea4825c905c5bc826bf63efcf00eaa6be053c6c97a4b70219b5fa411b1d45d38c87681708842b4b034860f2da6f8108646a1078daee90a01d4cd45b0e807b91196418bbaa69da67307ac802e11f97ce0ca94d6ee28264c31569a8ad3408c1825bf5ee5f40f8b4848677edd6cc540ffdfcd0686c31636facae8655518fa9c442cbd2311679cf6f187109ab9482d8037cc3be7085366d99357306ee04174b70edfe0791416d865318e6c2afff3f35f1eb91803c9e5c550b923bbdd07684ed2ec9cca504464be988d440031ea73d6507f878e1b1d5429949fe411036a621b237eb5cf46ed1708999b46569d33ffa1d18af6f4eac22f0c5c55a9bd8f5fed0ac4ba78565f8c70f4c3532e641276102f967eb9e438141772ba9f1913972f2d03526ace4d7cf1206d7d78bef099ef5b6522828e6ea1a485ffc8915b45906a458be7a7de161c475fe2870ba2e08608568b569d60418cc4aae4979428523a19ba46e02ae093f41e955be9fad3d10c0d885dc38199b32c3f65895f9a8ad08f15741a8eed44cd522fddfaafd63acd9f406fc56775c246005c3b0ce46378d02c0e891776b9b60f960cfa6c3961c71d190bc843eebad497b9b566fbce8bf91074f32ab939ec365dc263ce4a9b75e38b44bb7189a455ab05cbdfb4218ca75ea09c2d2430bd97d621dba2610c0062d878f836bd95b034a9ec6752187a778686ace2021aa196dda97186f00d259d8aa05b66ced650d79fe0f17830d2f791013deda17dcc3d2594a74f47a6bc3be4467ebb57e88f3a912dc7f9fbf3a8f7534742c302c4d159ce77d9765b8fe15015954abb4fda8fcb07dd77dd9bb2bcdc34c801487fbc30c2541f4ae1afe370ac24bf6347ae3d235776dcb87005124ea590868e5ff841b681fe6e538bb5f9a518b0a96e3005781443a59332ae3b587f060806acc8d4d35e91002fd7d0f6d56ba1c6e096655afaf511b2a513005448f92037c717e7a4e98ff3a2adf66698c7bd4837feafe54c1eae5b6d1bcff4727a2fe41d57d5c19f297500bcf6afe7f5745c811b86bc7cd805f9da6721d4522976d9e6cac6ce63b1639b9e5a3fb06990649621483f49f5332d2e5304defd03b330bb1c890c66f954bc34fa3e4d70a9cea827d8b661718a46b5eaf16a0e32456d98b88d89def7e8a5c80914c33692bc11df689d163817af49534ffc845170d2c318211daa5828c632450ed9a89e532e5823543cccc50ce81b25f3b7245ab7d80ce0c56583fb050067e7ca86e8282eb4a09842e2c465ce0888049acda15f14f77a65e44a1e3442cf0dab78ceafa53d43eba21d3f2af580aa2c766f382a2e81d9a416543699e974a497fbf0fa5ea4c8eefb516813bc4b0a561315f0896aade21c7078cfc9d5dbb985aa9f97481f94ec47ec0bc74d9d3d990c341aa2a1cf10e78f6c677a1c6604c6934dcdde247a270a02355396a16c8f2eeea2944c220f61838db90efbd3d9589edbb2c53d902a1e1dfb8f506737cf2e73f95b014f0e08642dc8727603943d7558bedf0862a295bb8e15735896d243f4f968c622853768230265a18a139c08dc8b3f295c6211bcb4b58cea5a47effc58576ed88ea0f6841215220c64812b69b80c2beb05d029bd4ea8432cad4a2640180cf3ce4da79a2e56981b16dcc707865d05c7b28dbadfda86292d1dab208a4e90c8a20394a547fe6a4c41df04f21656a9289984e5597dd04bb6f11661f06068a7715eb88e0cf64c3683c4fa043fd5ef0d77bc4e2159cf9693be052746b83f6f10024017b84069ad03e1907e7d646be84aa12ab131f0d7917ad81d43b0e3b9ec0a3db233d0a3d3175bae58548578ea71d55c6f375f303646e41f05206800332da03cdaf711fb30adbd9651025242b28c46403574c595eb6b7ddb650f58b3127d6c5e55c326d898c8ea5acaef921343a5964f1fe404f62ac0921263435365bee3f5563700f2d467293999ca2ff404f6797a3a61923555d8a96b80000000000000000000000000000000000000000000910141c20292f36"_hex);

    EXPECT_EQ(keccak256(rlp_rep),
        0xc33703062370d21e9df33c110aad758761fef7d6252dc6502a30ab1c961e00c1_bytes32);
}

TEST(state_rlp, tx_to_rlp_eip1559_with_non_empty_access_list)
{
    state::Transaction tx{};
    tx.kind = zvmone::state::Transaction::Kind::eip1559;
    tx.data = "00"_hex;
    tx.gas_limit = 0x3d0900;
    tx.max_gas_price = 0x7d0;
    tx.max_priority_gas_price = 0xa;
    tx.sender = "Z165f65c2985c4564b13fed095e35cd00abb8084ea6df59a4"_address;
    tx.to = "Zcccccccccccccccccccccccccccccccccccccccccccccccc"_address;
    tx.value = 0;
    tx.access_list = {{"Zcccccccccccccccccccccccccccccccccccccccccccccccc"_address,
        {0x0000000000000000000000000000000000000000000000000000000000000000_bytes32,
            0x0000000000000000000000000000000000000000000000000000000000000001_bytes32}}};
    tx.nonce = 1;
    tx.public_key =
        "01727d783cc48b50060e8d3cf86eb8f37a5fe0dd49beb6c79e77aa4243aed4acdc5bed459f9ce1aaee191558c4791a698778f22ae0b670dbc963f9dff974c5c4c7bdf86504364cd48ecbd37c990758e92abc82f9ab42eefac09b5c307064540751421eff33e436f05f59c0a43a3c1b93442fb8b75bc4ca7156310162c935c50dfea28b8f8cb3409edb3a3b8242ddc9320f97e2e9f3d50f4428d791d7969e412ba10a2b22c6229395dd86f86261104f3cf37617d370d28f484b2605828f03b017d898baf4b4631212baef96e81c017dab349d8189a70f07bfe86240d5f5a33802ca794072aef09b4171b153af2b33a8b375a113438d271cb0fe625d76e8fcca390dcbb924abf7ac9bc5e6ea6ec38cc7b4fb38ac22ded5d9280260c53f87186e8a1f44eeca54fd915015daeaa57fa3493130dbc0e3b664df05bce6cfbe8c10c1a7b7963ec5d9f6e044995050bc169b62de61e37e91eb83e0f21aa11018edd4f2587b2c907e1f99fc93a30935a9a16c828e778acb8d04e70e6a4cf248a1f23088fcde603ae156e538c1f2cc07e959f1a0d5d8771ee207284edc9e5f34785f708a9f1395cdbbd17fdfaa0792d9ffa1af4dec2907b603698bc71621df7e34c6adf001951252b97d69590d7cbf7a102734aca33b3a337ce3deec222f2b8b61c45ad189a75dd30746ec7c9700fccf361b94b23564c974bd024b89a52d3f225d0b562e4500b51e0c447caeff5eb760d781c416aabf702c079baad87fdb18c61d50cc8827e407fe088a8da4575a92e13093d24c63ff37ac70bb2a6be9631891b0dd570a7fbb73bb66d489058ac89c46db31576a38dbe2a206a31f48751b45e1bf7934fd8fc2d242273aa1261ca679a6ce693a458a5a33d47d8b7a8aa61f62060424bcf911f147206c475842c16dd801e4ac32a8223215ad3a4e59deb4df0597a612c330af5a787f05327cc5cac9e8a9d151adfb0413b5a68f124d9f1cbe753137061f5beb8ec2b9be66ea23076f2d6da6624a983f76ad92235315a3883c2a321b013586c055941514d3a6d448ff1d6cef057e4ca26b944d44086f4df7970371464c56151221cb808f0e00818cd0ffa916b78e696132ccc71a795949a39f2a5a6acff20998c085e640c901f251998d15d6cb7092dc48e69284e4836e634db47664f926697055252be841a5a79603f8a2a419650a6f1ad7c6bdb11a391bdea76f4f68be08922f5ef08bff8c0d02d5aded7907642cc6cca4fd594f0fe4700efd15827ae2f4a9c7f8f629498f1992e4cb575ed9bedb1927bd57bde751624a34c8438892ac114cbe1aac962cf4fe199d2ff2a23cb1f8c3a3e6d78a8b44b66d8f25c3702bebbfb1974698ac701d263561a32cec56574e1eb9f289fac40fa441296d79ae4f0f51c8e9a50d7acc1779b5a47a806c692a1c49e99fafb63d2149eeb175aa7ef584cbb5504211fbe6585e30ba0edbb717decc3494ee984d5f3e56089f14ce7222c6573833377881a861fd763e4fb667c9e76c860ffdee0771465f5a37aad543e3fa5f024996dba344f6a1c24b245a45adc6a18ac4dd08bb0307910724007e344ad302b534dcf7dd2ac3966bd3668486ba361ac1390155c0e1334d3a79c631f889bb26dda72449129d4441e795f2c124cde229d4daf79bc9f15c562fc0f6faa47f6b757cf4c7d0d6271c1e47f3d01ac02938eef495ca61e051617f32693a17abacf604722025f72660979716407f15d56a71b1427019b2b8897a7991f6d9bead653b537670bf4c5e7bc54b8745b533ab4bb96b588bdeb2b4f713f25477688737dde64107d82feabc00a2689f27b1b58161b6281d9edd647b8d23e9442f2123c93365f6805cf903b8a802a2de6d5622407cb9d88512fcc9ba9f18c90cfaa80e1e9f985e9849c8b91d9cdc1f862135f6583aed4f5471124408a89081c0e14789ce8f2444dee55f789387e6e48e6212fd271a1e3a55de0c1e122c8772dc32d1ca77284eb4649e86ae6e5569a4cf840166970a21d79c50a8fc9b2d1c144ee79885ffdbc22737b03a110b3522ea5c26ae99f950aec20411cd1c2466df4d90c3ffe2ed9116b6c23a63299f6d7bbcf2a37368765d170297d900ca346fa60f0e6a3fccf2a01548219982c5e49444771e64619089da4c6263df7ac2693d9037800f68607a34d7eeb489b1a93030488d7cd407f4f2ab561701d884d7eeea39f79cf2f25c4da089f34ea3f3dc15da1bc43da8e7c12d1e0c05b107f10da1ea5a684331f2ecb696734b47407dc51a15ab9c9b98f31a42cb2e771696ab39378bbcfec21021bc42ffb1488920229589505bb6fc771edddb1818a081a5b8fc90eefba70091ea3fed3fe81f95f721570662eed03cfd759fb064e2401e634072557f025cce8affff8c062381b5e0291fb016292b5403848b419037d9bb6190045eb19454c2ea2debec95eb9d7f76f9546c922f96d1a04c537594ef5d26b226821a3527cebd56ac950c54e7fa0557e017e9a5974ae7defbe1fb3ba3037f89d12ea7f85253ef885af0da7b1e60a8637d1197b795a9d663723b94f1806b2938b5da325877d7b85ec544bbf311f75cb7e17999518cb473a5cb7875ba4e59a904cc09992313ee3f44890498af5443d983a4ad2669fee3c47d592e788c56419b1e93bdaa5434ce895506adde41e75f89dce82e6fc78cf0b85850808037c172d5a44848525d1f06cc7f3610adf434ae21c1313c438eaf9b0cd4d18d4f402279a7db469080ee807630b0388046551ca3476914e3a2a2abc0b7fc211fc17a48c0b42800406738dce93b19a64dcc3cb93435ec117462ddcfd396daf99acd0bf2037a21fce0a46dbbfd974121669287f409a778b538f862eade58da183e9bd37c763a16f56b15d8d0c8ab6326189ca7116c587b87659ae82be17639362ecaa78f7ad346ae82a8f85bdf0ddc38054b9239ce975ee723ffc854ae4d028c20dae5d7cbd1b110dd749049c89878f797a20fc15ea9f6839c130253d4fa6d506fecd3605a8dfa35b13ff61e2f9d865224df588cf8d51d00341b8c607b64158903c171d76e7b303d0d1349374f6f06f080db74f55ecbbf8a038cc209bc4d86d63d9c8b7309a423b29048abdfb8849196bdea7a2a55a9b6f3c4e8019cc80bde6e6ddff2bac293c50f4f739a21331495b960a242d2d126832283f09a9d0ef145ca9cd5b513c7d72e2670717709e169e03d4d618ba6c319ac03a4c65cf7cdd050745f0ce0f7872fff4640741284ee26f1585e05978e53e1fff5a89322e9b770bc29c697e9843157f9f797f37ed45f9992e333d780fb71ea992624c195d0e8dc008877a5adaa89d8aef5b6533c2481208a946a5b32f3c95e4e518fc1c2e76bbceee2ce18703ce38e86cc09bdfda8b90c0beb6a7ce0321f9f8acd27f93800cc79dfd671825974516554e68ed1953a80d9e1a51717f06e2392612843eb73783eb74d1db18ee8c56929ac41bec655957cccf68ab3810cfb099aea1a1d7e064afe0b248d60d8aca916bc5529555ad94af922481f535f60a060ec63b887b183378355a827dc0da8a87fef209dd79ad207c482423f2d45fd4e4e8019122afe9bf5e4fac379567c13f44c35061fbdab4939f429354f4841cb1f15ec30fd69b361596e1259edb9f506a80dcd5a17786f4eb8e35fc1556fc9fbdf18d9"_hex;
    tx.signature =
        "e73bc1b1352bcb75d32a35ed10465f6c77904edd91463ba674ea0abfd56d72625b050ddcc459f3f5f94f1d3a8c7123343eb17a3bf119fe4a6a9fbc1f965e1059613cbadfb2d99bb813ebb573fb946bf1d17bb6a778f499461e6c1d9cad39bf46c80af3cfa34d5d3cbec87289f95411551f43b6dd46e40779758ec7af2db2a0abfb561835b7242dc1bc4876c50dce06aab9f1f72c9fe61ef89c92316a3333c22c026d2e40762cbe804b94a65f00d5b4289856b4f8379a9362390df3598098f2c17816bd57188530160a6c4b050e88da400d4584cdb8d9baf883b9b23b4d3194f47f38aba8f7488bbefc8f78d2c4f41417a179e0e44e251839088497b7d4b14c83a2f181ca28151b4860deee13bcbcb2fec1c44c729f9e61268c377fe8972f7c0cef7c93f646cdf58473b8d748cc16fc75d8cdd75debc293fcb027104fa06127f920f99af964f41bb6107a820197f682bb988393d349cce607d41824ba2866074b335cd3a88cb326a0f855cab0dd17ca294149356255ad4b4f4295de9f2803ce5830fad2af294f380f069ba1e5fe81ab493c14f449f70bad5e29ea1da90ceb229b162db1d42cfb64fb88f75655475667234366f941066965b79ce173771bc2882a719e47ee6e6b86654ea7a0fedb97a7dbfd2cb492fb6eee903a0254d7106838e696d24cc535fe8fd3357d40e118f4e696dbaa9b5fbdb580eeaf969ad59d8d56f18c7e365baaa163286560f4092e016bf5aca661333e86cd464f69596a9b25f0ac1a3fd15c777a076a6d03d059dc607a765df9e9787ba0c99a93363cc53056b7db387265a21aadaa0e4ba2e308c627e8c198131fb77526c38d3a721a27529b7647c2d001566bca576e430edfce7f58a316be24ce3a5f4213d4c852408760b28073e9c87fb0eb769514d6591a02adecf193348295a39dd5f3e6c2459c702c0ca0963580c67701a7c29c38ca49126e1a8371b279986264003c5d006de399b445256074d10c1c02c0088f85f1f907c5de72ccbd86d7abf4bde2090964a38f83dfb9284ed543a6b91f692b13d2b2c168b469e0a074642c0f9f3bad8fa4849ff5cd2bbd684e00b2af06b0bb61643a78e178ccc093bd2ccecae9860e1d36831ec6b401c46bf3942a5782e68a487c2f2ed2a802bb5fd75d6c886ca71d537282c5554634007c93630c2da3f6828a8cd047188007fbed2fdcb6bc665848c1bbfe1089c80b5322f86fa278b8334bf821e9c3ed983ad6a5829c5a14676ed26316a8bccbe6a47e8073f19bc7319ceb95422dd7a9c2587d6faa51fbe40e8aff0ed48f186c4ade3bb9d3bd7d208a4611fd91caa96bd3e84d5d3f3f225f41c97a3d6b29ffb9893e644afaf668af95c3cfafd02f3e3b595f334b7bdd064eaa31ae934079ad9a4abbab97425aeda04efa63d07e71849c7290df1c561545d4d828c403084485f714b5f993a0a4b2c0d39b98f0dcdea600467ad46f82eee3453ed22f6b390deef5de2ea0ac703599cde5c63f3f1b2eb819e6f3b3f842bcb51f1248bd92cde45b3e1323390a74f976cea95b6f5c31e55be8e1bc7d9792d2bff2735690abe24bde6cd71ecb443d7e4a562145bf0b9f472d610d61edd1dc2aa862be918d9b3a6658cfddd40285fedadb71f623d265182d83861a6729c1e00c38b838841c685b107ac8523152ad6f63cd94927d66ebf8c9be51f26a5c58cb74c515d57da1610fd1f04caf192088ffba5360b102635bb2762c1f7023eda6495b2a5b02297731c05d2e46eab147566bb516d926443a288caa52f26af9e9dc5432fbb746b4ff90b5db85d82be934f5331a858a561600d846c3f105926be5e342023c063affbbfb0a8d1194f14506f91df14005bf8d7d940123ec3ddefac426dae522fd2924153147b2a8e37cc303b2a62e4e3ea946e41003ce0113ca2cb309d306372efdb8e028cf25b9dc99fcd1190750887803ff08aded54461efccb424f90697141502f4f54c7edcbfb549ed224ac74f95e0e3c554ebe6daf4e4860d7dd9ebab84b837ac770b2ee1b7d37d323d578f1b71a7920298be1f711850409332bcf82b4386c0b6d291e643dfc7e0a8a27ae20dfebf8ca3e25767a2b10aa442c92090e176ede1d23d0396a196cb3af4140e6735316a1549e6df2ee116a39594f04933346d009805e25e450de564735c6dd5228fbc08496ae7d5078dd0ee16229d7af5e3fda75a3b2ef5deea42d96aa824dea8ab3d41a47068bcc544bbcd7aeef37ebc571c8f7cbae01ee541f055a07944a16b300894264fa7e7819fc43599264691773011851a25a5632eef69b3a55625fac004b1878868d1ddf51b957e45326a1cc3e72ab728a838953c94a0a7fce794b909e2b0e2bb99baec133857e1e01955caf7e5d6914c633cc0a5dbb2fbf47826666b20b25fe61792946dd897ffd296f107c2a130447c4c4350b600748f4eac9020dff429172bdc70d1c2d7e01d3cf3802bc910cb70338d1f8466b33ff33f12af6159b7278458c64db77364bab343870c09e977fb58f7cbd0439d34d09d493fabfe4a1856bd031bb1d654f48d6811cb7638d83de3fb7b9f318bf9cb0dd5fb4772444587cc22f7b147bf4dfa1da82c4f68fe8eec12c976beaf692790d27e713dc40ea632129ee256fd302233e2625602dcf5589d709633b4e1ebff57cc6887a1fada13b5825ba10ca917d95a47a92a097ca523fbeca0a3132369d8c60347fdb6c4fb0dac59cb808af556ed7232a516aaa7a8b283ff531d2ce478c5bc98f69f4a8d20715586b24379d265252ea4c1432ea6439c38a1f02d5ddb53aa9cb6bc50e5c49c77cb3fa726d013ea2b8ee20149786fd55ee84aecc064dc9b2e714efe61ec53d7de85a796ce46db77d93bdced61591e5fd318a40212ebe6d957520a6aa0dad42ced47072b6a6612039cd0a7c1bbd9844afc0ba448b9e112fdff7629d0e3559bfcfb214c1c5aa8e185058993820f55f95eb2ad233fadd9f96c33f5206f8556e7377f2073a722de91b070bf25e89ddde0fbc34181b601b2291d867a8637802e6394e49a6fd749da265e76e019d0e3bdaeec6d317d2f7b2956aa023d1febf90e314d50b94489fb59920e19eb9c5f0e04050c626889bc2cf484149c60e152f65ba4ad8354b4597f959720828c76a98f1d419a4e6b06d7f6e30da15b31e56bb3843a4ef0ccf69e814fa9eb897de6ed6f6a2ac5da767a2427fa9ce182473ecff44abe9419b54d71a10e067eed038405c2259cd59147eea9f64526a93dda4b4dbfbdda32e36536f8a2f1a908bb574a46b426e5c7cc7c700e15aad048360aeaaef201ba781556d8024f922fcf6a51ae887671398a9e29ed506ed380105c0d242d588764b5a1241dc6f838fab2c5f2d512093894015e77aee3feef86abdedb10e9724a13a6bb038e2cd3b3c9e84ae46ce9a4c3a25f127f620043283ebfc2346c88f602c90d25b8ff73c6124aa283fbed8f9d1958791c1894cedeaefd41926019c94e071310a78c8c7c070350846957d600dea60fc31756e7fa37e3f87eec505adffe938e954b01e00fac6c8131c38aea3d9ffe48914b94191829bfac2101c8469d62888307071d94054ab91fc5e3af8a6f2160dc157ac9751220d9e3f89833e22e71355899463e29dd9a7c9e44ec6bf91d45cf73856d1e41cfeebdc134c5f4cbab81adabac969b36add345532aa0ded69528085e6b47a70488b5b0beb5650964ccf58ed049db4b9113614c1f64282d566c6943e275c292195fe7ab4e2b453f3e6334681633efc470807096500291016a5b1dd9e7bac14deacf227fa215cec9d7cb232c90ce672f590372db192a455e6351f92e6a02b90731d6ffe3fbe0d1623d878e44b4a5a75c0e7dcd31724c753f75b92b764d93e86538cf88068f94c7476de759b1761de41fcca9b016c54237c8e33962358012c4ffac5e7662544b284fe5877142f12cb0ab61f034930665d0bead6599b2accb4677b618e0fd717d69e46632c8e77eb8974fb7207df4311e7108990031aa8808732265bc521ccf0943ced9e212954621820ed7182251ce29a82f213013ef536fcca588642c4e45bc4e0efc0b6d6fca4ed6a7bb8d8261f993390da9e33416bbcf19580ae80ae8af63dc61fb7b46b396aad9236c1d76d7482394b2112112388855e2ebbfd093f23710f24187e18450da9fa94712f766753f1ba11e7bdb9a27082a34f32038426c4fb11ef593c9d1d7412f2e3761ee87ca1ddefee98d83933e13ca477db35215146ff4159964299a3b798ac549bb7574e13c6739150595b29605411f84a6a68c0486963a5e54e3328f394e16c79bcd169b0ae5a5ea8b681730d04a76fbfd980311441d65036a4735b5130f2e8232c5ddbfb705d632e1151ca4b52b251d0458081db70207f9c2a831818345ca4a6c8fc81f9aec7ad23861c3a30c162144b311f21bac38a397b825e2aa72244832ec3e090d79310733d8a3d9a57879aab8cfa22af5f725a40b361e6f704b359e1b47aab5b57d01e21f56a4d58a4de7c2a5c1f43ceb410eccab638062ace36374cb6fefbe568b4b91d5031b20682d95aed6525dc206d4437f43eb8b5d140d3ad2c10cdf6de24c2a59417cef52f23afcb7610d679e885511736c83934f8022a83cd5f54d1089ffb97108cc41af94357023dc7cf9fef21be9202b183f50e3a2de9e8f8d1110a047a9ae0b31e83901d63f8f2ff3f9ac37c958f4f281c54d1e030617fdcdaddb02ce07e917a50f62e792665a843ea453d3453f66e5d8100eb0d828480e6bfa0242ad6296a061f87a62162893373e1fdca38dbf280ea9b9096b46965086f84d5e73c27febf211dd1c169a804779df0684fd9a4a0355a2f8e8d0542830345b6432d96527f9782aad5ef6efbbd69ef722b4c89cc42b7537a828e9b42009552e0d09063de8b33dc1d6a8c82cd84170485a6038e316a9b8ebbfc8e3c2c305615429643a7a848c68ebdebe953af0b4f73c14813cec97deb729686201f977744c0289eadba2cbc11eb2d69210f47d9982397c05e33d372144b39f017c51bf768456dca588fd8c37d778d88e1fdb5919301a61aceae00c2f94d1e42feed62dbf824983d89c929b7d4bd94eaeb4741d52b7589969bfd9aeb0bba507de719d87e3abe3f1541436d9bd1f719bfb903746e5713b35d3ebcad5c7af3885a5195c67ed7fcbdb144373f06c61de26e7ad0ceef190b05c962c97d36b328978bfbf23d92bbb7b693fe4e5b0e6ce30c3ca4b9a15d521efeb172ebdd13c2c173f350745deac9e190a510a41049a19d57fe98cdec592990bb1cb7819aa40a6667e1ca7925d5390b81fe68641f0a585b4d4488375843d9ed78d1bffb8567cdcbf36b40e801630fbacd7cc2b61b52dd4a5a59c8c7e7a88bfa252ab97a1588a412e508907e2f7e1107016db2f833f35edb83af501a159f24e2f0a2e3454e7aefaee357192ecde73019c33ed84568797b2de0314df1702b8976b973c9cc19a3bd434ff134edf2144b0e6428cf77abb2b0e5a9b7186b9cd64a3a8f6583d51b26d6bd0c8d874b6a615590b71876df5be86f0ba23ac290e353772edc5a7f11702bf3772933eb384122c201e1181cb2e2c08e7ec52b1e1d86926774d247c6261696fdf4973d065663af2e954ab0813f6c48e1bfb530ee2f889c3db43f5678526201aae06d13fc935df91fa63491d4d287122ccd8d40b79236f15a4949e89f7be3896844b3e778aa2e9a752016eb24c4b1047b20e28b3b92e300334ce542ba493034ebacd353fe493b00f800b34ceafbca19fd29b1bf120503a9b7d9b85d9c86accd9d6497a7f9f980665b4773649788a8d315a8a0c5b339099888a562183d52e7735b46a8b38de8ac9c3cedcb39fc420f71e2d4b16ad9cc5837a21738e6c6a293213c427c11fe9762a115dd7de3c0d64df9ba8f72e19170bb6243ce66a2f44fd83dda5abc0e05709ce2d89870255647288d73ebb81dcb4fd9b4558fceb62470316ce7d4f89b28a7dca7c510f939f6ac2d0424a812ac6c3d0ae7082a8c64e874cf34accc72ea6737d7f1c04c5cffaea2bda3c40010353df1a9156e80f45f521746f6145fb325e1129fb83527c7af2b2c4c78a656465b8b630bd357b1fa4dcfa35143dc250856f1bbfc607223ff6269334498f8e6fe323421ad06a20cea74de65c8df7f04792de55f315caf47568514b60d5cc469399b4ccc3e45352ee928bda04fa1ae698b66f4f93589dd0b54a084f6fe9d32e3dcc286bf1354df73efe3002345e836f85da178d91a1ab1efd9e59aa45f56589d918464cc7193ba91b6bfc2ee2aeac021b0450abb03c6a3110c19f4c0dab0fe3d8b6fd8debe141d63668ebb91cc1fc4e3140890d2c7c4dfd1b0b4f1085f22c6c78a51996c0ed2e441dad736387d1ee1b8ab41041f3481d3ebf6292b6985a5b2d50f1540538492a6daec0935467097abc7c85f6a77838e92b3d6dd3e7d82858babb7e9ee24275eb3b9c1c8e0e2348594afdde1e5000000000000000000000000050c151d262f383f"_hex;
    tx.chain_id = 1;

    EXPECT_EQ(keccak256(rlp::encode(tx)),
        0x2f2d90b6d9dd9f0844de22604c7302244e93b673062e0b1fb20af32095bfa0f3_bytes32);
}
